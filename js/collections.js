var collectionList = [
    {
        alignment: "Zarosian",
        collections: [
            {
                number: "I",
                display: "Zarosian I",
                artefacts: []
            },
            {
                number: "II",
                display: "Zarosian II",
                artefacts: []
            },
            {
                number: "III",
                display: "Zarosian III",
                artefacts: []
            },
            {
                number: "IV",
                display: "Zarosian IV",
                artefacts: []
            }
        ]
    },
    {
        alignment: "Zamorakian",
        collections: [
            {
                number: "I",
                display: "Zamorakian I",
                artefacts: []
            },
            {
                number: "II",
                display: "Zamorakian II",
                artefacts: []
            },
            {
                number: "III",
                display: "Zamorakian III",
                artefacts: []
            },
            {
                number: "IV",
                display: "Zamorakian IV",
                artefacts: []
            }
        ]
    },
    {
        alignment: "Saradominist",
        collections: [
            {
                number: "I",
                display: "Saradominist I",
                artefacts: []
            },
            {
                number: "II",
                display: "Saradominist II",
                artefacts: []
            },
            {
                number: "III",
                display: "Saradominist III",
                artefacts: []
            },
            {
                number: "IV",
                display: "Saradominist IV",
                artefacts: []
            }
        ]
    },
    {
        alignment: "Armadylean",
        collections: [
            {
                number: "I",
                display: "Armadylean I",
                artefacts: []
            },
            {
                number: "II",
                display: "Armadylean II",
                artefacts: []
            },
            {
                number: "III",
                display: "Armadylean III",
                artefacts: []
            }
        ]
    },
    {
        alignment: "Bandosian",
        collections: [
            {
                number: "I",
                display: "Bandosian I",
                artefacts: []
            },
            {
                number: "II",
                display: "Bandosian II",
                artefacts: []
            },
            {
                number: "III",
                display: "Bandosian III",
                artefacts: []
            }
        ]
    },
    {
        alignment: "Art Critic Jacques",
        collections: [
            {
                display: "Anarchic Abstraction",
                artefacts: [
                    "'Disorder' painting",
                    "'The Lake of Fire' painting",
                    "'Pandemonium' tapestry"
                ]
            },
            {
                display: "Radiant Rennaissance",
                artefacts: [
                    "'Hallowed Be the Everlight' painting",
                    "'The Lord of LIght' painting",
                    "'The Pride of Padosan' painting"
                ]
            },
            {
                display: "Imperial Impressionalism",
                artefacts: [
                    "'Solem in Umbra' painting",
                    "'Consensus ad Idem' painting",
                    "'Prima Legio' painting"
                ]
            }
        ]
    },
    {
        alignment: "Chief Tess",
        collections: [
            {
                display: "Blingy Fings",
                artefacts: [
                    "Ancient timepiece",
                    "Legatus pendant",
                    "Pontifex signet ring",
                    "Bronze Dominion medal",
                    "Silver Dominion medal"
                ]
            },
            {
                display: "Smoky Fings",
                artefacts: [
                    "Hookah pipe",
                    "Opulent wine goblet",
                    "Everlight trumpet",
                    "Dominion torch",
                    "Pontifex censer"
                ]
            },
            {
                display: "Hitty Fings",
                artefacts: [
                    "Ceremonial mace",
                    "Pontifex crozier",
                    "Fishing trident",
                    "High priest crozier",
                    "High priest orb"
                ]
            },
            {
                display: "Showy Fings",
                artefacts: [
                    "Crest of Dagon",
                    "Legatus Maximus figurine",
                    "'Lust' metal sculpture",
                    "Pontifex Maximus figurine",
                    "Ceremonial plume",
                    "Rod of Asclepius"
                ]
            }
        ]
    },
    {
        alignment: "General Bentnoze",
        collections: [
            {
                display: "Red Rum Relics I",
                artefacts: [
                    "Ork cleaver sword",
                    "Ogre Kyzaj axe",
                    "Beastkeeper helm",
                    "'Nosorog!' sculpture"
                ]
            },
            {
                display: "Red Rum Relics",
                artefacts: [
                    "Hobgoblin mansticker",
                     "Ourg megahitter",
                     "Ourg tower/goblin cower shield",
                     "'Forged in War' sculpture"
                ]
            },
            {
                display: "Red Rum Relics III",
                artefacts: [
                    "Kal-i-kran chieftain crown",
                    "Kal-i-kran mace",
                    "Kal-i-kran warhorn",
                    "'Da Boss Man' sculpture"
                ]
            }
        ]
    },
    {
        alignment: "General Wartface",
        collections: [
            {
                display: "Green Gobbo Goodies I",
                artefacts: [
                    "Ekeleshuun blinder mask",
                    "Narogoshuun 'Hob-da-Gob' ball",
                    "Rekeshuun war tether",
                    "Thorobshuun battle standard",
                    "Yurkolgokh stink grenade"
                ]
            },
            {
                display: "Green Gobbo Goodies II",
                artefacts: [
                    "High priest crozier", 
                    "High priest mitre",
                    "High priest orb",
                    "Idithuun horn ring",
                    "Garagorshuun anchor"
                ]
            },
            {
                display: "Green Gobbo Goodies III",
                artefacts: [
                    "Huzamogaarb chaos crown", 
                    "Saragorgak star crown",
                    "Drogokishuun hook sword", 
                    "Dorgeshuun spear",
                    "Horogothgar cooking pot", 
                    "'Da Boss Man' sculpture"
                ]
            }
        ]
    }, 
    {
        alignment: "Wise Old Man",
        collections: [
            {
                display: "Wise Am the Music Man",
                artefacts: [
                    "Everlight harp",
                    "Everlight trumpet",
                    "Everlight violin",
                    "Avian song-egg player",
                    "Keshik drum",
                    "Morin khuur",
                    "Songbird recorder"
                ]
            },
            {
                display: "Hat Problem",
                artefacts: [
                    "Beastkeeper helm",
                    "Imp mask",
                    "Ekeleshuun blinder mask",
                    "Flat cap",
                    "High priest mitre",
                    "Huzamogaarb chaos crown",
                    "Praetorian hood"
                ]
            },
            {
                display: "Hat Hoarder",
                artefacts: [
                    "Ceremonial unicorn ornament",
                    "Lesser demon mask",
                    "Greater demon mask",
                    "Kal-i-kran chieftain crown",
                    "Pontifex mitre",
                    "Saragorgak star crown",
                    "Tsutsaroth helm"
                ]
            },
            {
                display: "Magic Man",
                artefacts: [
                    "Ancient timepiece",
                    "Chuluu stone",
                    "High priest mitre",
                    "Legatus Maximus figurine",
                    "Portable phylactery",
                    "Ritual dagger",
                    "'Animate Dead' spell scroll",
                    "'Exsanguinate' spell scroll",
                    "'Incite Fear' spell scroll",
                    "'Smoke Cloud' spell scroll"
                ]
            },
            {
                display: "Knowledge is Power",
                artefacts: [
                    "Crest of Dagon",
                    "Golem instruction",
                    "Necromantic focus",
                    "Ikovian gerege",
                    "'The Enlightened Soul' scroll",
                    "'Da Boss Man' sculpture",
                    "'The Eudoxian Elements' tablet"
                ]
            }
        ]
    }
]

function createCollections() {
    for (i = 0; i < collectionList.length; i++) {
        var category = collectionList[i];

        if (category.alignment == "Zarosian" || category.alignment == "Zamorakian" || category.alignment == "Saradominist" || category.alignment == "Armadylean" || category.alignment == "Bandosian") {
            for (x in category.collections) {
                $(".artefact").each(function () {
                    if ($(this).hasClass(category.alignment) && $(this).hasClass(category.collections[x].number)) {
                        category.collections[x].artefacts.push($(this).data("artefact"));
                    }
                });
            }
        }
    }
}

function highlight(artefact) {
    var div = $(".artefact").filter(function () {
        return $(this).data("artefact") == artefact;
    });
    
    var top = div.offset().top;

    div.addClass("highlight").css("top", top);
}

function removeHighlights() {
    $(".collectionViewer").data("active", false);
    $(".highlight").each(function () {
        $(this).nextUntil(".highlight", ".artefact:not(.highlight)").find(".cell").css("padding-top", "4px");
        $(this).removeClass("highlight");
    });
}


function highlightCollection(collection) {
    removeHighlights();
    var artefacts;
    for (i in collectionList) {
        for (var x in collectionList[i].collections) {
            if (collectionList[i].collections[x].display == collection) {
                artefacts = collectionList[i].collections[x].artefacts;
            }
        }
    }

    for (i = artefacts.length - 1; i >= 0; i--) {
        highlight(artefacts[i]);
    }

    var numHighlightsInARow = 0;

    $(".highlight").each(function () {
        var numAfterUntilHighlight = $(this).nextUntil(".highlight", ".artefact").length;
        numHighlightsInARow += 1

        //There are more than one non-highlighted artefacts after this highlight in a row, and this is not the last highlight
        if (numAfterUntilHighlight > 0 && ($(this).index(".highlight") < $(this).siblings(".highlight").length)) {
            var padding = parseInt($(this).outerHeight());

            for (i = 0; i < numHighlightsInARow - 1; i++) {
                padding += parseInt($(this).prevAll().eq(i).outerHeight());
            }



            $(this).next(".artefact").find(".cell").css("padding-top", (padding + 4) + "px");

            numHighlightsInARow = 0;
        } else if (($(this).index(".highlight") == $(this).siblings(".highlight").length)) {
            //last highlight
            var padding = 30 + (30 * $(this).prevUntil(".artefact:not(.highlight)").length);

            $(this).next(".artefact").find(".cell").css("padding-top", padding + 4 + "px");
        }
    })
}

function checkCollections() {
    for (var i = 0; i < collectionList.length; i++) {
        for (var x = 0; x < collectionList[i].collections.length; x++) {
            var collectionComplete = true;

            for (var y = 0; y < collectionList[i].collections[x].artefacts.length; y++) {
                var artefact = collectionList[i].collections[x].artefacts[y];
                var toCheck = $(".minForCollections").filter(function () {
                    return $(this).data("artefact-collection") == artefact;
                });

                if (!toCheck.hasClass("complete")) {
                    collectionComplete = false;
                }
            }

            if (collectionComplete) {
                var collectionLabel = $(".collection").filter(function () {
                    return $(this).data("collection") == collectionList[i].collections[x].display;
                })

                collectionLabel.addClass("complete");
            } else {
                var collectionLabel = $(".collection").filter(function () {
                    return $(this).data("collection") == collectionList[i].collections[x].display;
                })

                collectionLabel.removeClass("complete");
            }
        }
    }
}